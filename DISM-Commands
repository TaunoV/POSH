### Parameters
$wim="C:\Program Files\Microsoft Configuration Manager\OSD\boot\x64\boot.wim"
$mountdir = "C:\DISM"

### Get WIM info
DISM /Get-ImageInfo /imagefile:$wim

### Mount WIM
New-Item $mountdir -ItemType Directory
DISM /Mount-image /imagefile:$wim /index:1 /MountDir:$mountdir

### Load Reg Hive for editing
reg load HKLM\DISMHIVE "$mountdir\Windows\System32\Config\Software" ### Hardware, Security, Software, System
reg unload HKLM\DISMHIVE

### Dismount and commit
DISM /Unmount-image /MountDir:$mountdir /commit

### Dismount and discard
DISM /Unmount-image /MountDir:$mountdir /discard

### Cleanup and delete folder
DISM /cleanup-wim
Remove-Item $mountdir -Force
